import{k as ee,_ as H,l as se,m as O,f as S,i as te,o as v,w as ie,a as i,c as x,g as U,r as j,n as B,t as C,F as N,d as q,q as ke,u as xe,s as D,b as z,x as X,h as w,y as we,z as Ae}from"./BXlpFhld.js";import{_ as Se}from"./CW4rylCo.js";import{u as le,W as Le,a as Te,c as _e,_ as J,d as qe,b as Ne,e as $e,A as Ce,f as Me,g as je}from"./CAeaQecl.js";import{b as Ie,c as We}from"./QzWGY4mI.js";const Y={by:"id",dir:"asc"},ne=ee("wikiWeapon",{state:()=>({items:[],count:0,loading:!1,error:"",loadedLocale:"en",filters:{search:"",jobs:[],uniq:!1,types:[],positions:[],positionsUniq:!1,labels:[],hasSkillId:null},sort:{...Y},page:1,pageSize:30,rawText:""}),getters:{facets(e){const s=new Set,d=new Set;for(const r of e.items){r?.WeaponType!=null&&s.add(r.WeaponType);const f=Array.isArray(r?.Tips_Label)?r.Tips_Label:[];for(const o of f){const p=Number(o);Number.isFinite(p)&&d.add(p)}}return{types:Array.from(s).sort((r,f)=>r-f),labels:Array.from(d).sort((r,f)=>r-f)}},makeLocalizers:()=>e=>({nameOf:s=>s?.i18n?.name?.[e]??s?.englishName??"",descOf:s=>s?.i18n?.desc?.[e]??s?.desc??"",locationOf:s=>s?.i18n?.location?.[e]??""}),filtered(e){const s=e.filters,d=(s.search||"").trim().toLowerCase(),r=new Set(s.jobs||[]),f=Array.from(r).reduce((k,c)=>k|c,0),o=new Set(s.types||[]),p=new Set(s.positions||[]),m=new Set(s.labels||[]),h=s.hasSkillId,{nameOf:_,descOf:L}=this.makeLocalizers(e.loadedLocale);return e.items.filter(k=>{if(r.size){if(s.uniq){if(k.JobLimit!==f)return!1}else if((Number(k.JobLimit||0)&f)===0)return!1}if(o.size&&!o.has(k.WeaponType))return!1;if(p.size){const c=Number(k.PositionLimit||0);if(!Array.from(p).some(u=>(c&u)!==0))return!1;if(s.positionsUniq){const u=Array.from(p).reduce((g,t)=>g|t,0);if(c!==u)return!1}}if(m.size&&!(Array.isArray(k.Tips_Label)?k.Tips_Label:[]).some(u=>m.has(Number(u))))return!1;if(h!=null){const c=Array.isArray(k.skills)?k.skills:[],y=Array.isArray(k.CommonSkill)?k.CommonSkill:[],u=Array.isArray(y)&&y.length?Number(y[0]):null;if(!(c.includes(Number(h))||u===Number(h)))return!1}if(d){const c=(_(k)||"").toLowerCase(),y=(L(k)||"").toLowerCase(),u=(k.englishName||"").toLowerCase();if(!(c.includes(d)||y.includes(d)||u.includes(d)))return!1}return!0})},sorted(){const e=[...this.filtered],{by:s,dir:d}=this.sort,r=d==="desc"?-1:1,{nameOf:f}=this.makeLocalizers(this.loadedLocale);return e.sort((o,p)=>{let m,h;switch(s){case"WeaponType":m=o.WeaponType,h=p.WeaponType;break;case"JobLimit":m=o.JobLimit,h=p.JobLimit;break;case"name":m=f(o),h=f(p);break;default:m=o.id,h=p.id;break}return m==null&&h==null?0:m==null?-1*r:h==null?1*r:typeof m=="string"&&typeof h=="string"?m.localeCompare(h)*r:(m===h?0:m<h?-1:1)*r}),e},pageItems(){const e=this.page*this.pageSize;return this.sorted.slice(0,e)},filteredTotal(){return this.sorted.length},hasNextPage(){return this.page*this.pageSize<this.filteredTotal},totalPages(){return Math.max(1,Math.ceil(this.sorted.length/this.pageSize))}},actions:{async load(e="en"){this.loadedLocale!==e&&(this.page=1,this.sort={...Y},this.filters.search=""),this.loading=!0,this.error="",this.rawText="";try{const{data:s}=await Ie(e);this.items=Array.isArray(s?.weapons)?s.weapons:[],this.count=Number(s?.count||this.items.length||0),this.loadedLocale=e,this.rawText=JSON.stringify(s,null,2)}catch(s){this.error=s?.response?.data?.detail||s?.message||"Request failed",this.items=[],this.count=0}finally{this.loading=!1}},applyFilters(e={}){if("jobs"in e&&(this.filters.jobs=Array.isArray(e.jobs)?e.jobs:[]),"uniq"in e&&(this.filters.uniq=!!e.uniq),"types"in e&&(this.filters.types=Array.isArray(e.types)?e.types:[]),"positions"in e&&(this.filters.positions=Array.isArray(e.positions)?e.positions:[]),"positionsUniq"in e&&(this.filters.positionsUniq=!!e.positionsUniq),"labels"in e&&(this.filters.labels=Array.isArray(e.labels)?e.labels:[]),"search"in e&&(this.filters.search=e.search??""),"hasSkillId"in e){const s=e.hasSkillId;this.filters.hasSkillId=s==null||s===""?null:Number(s)}this.page=1},nextPage(){this.hasNextPage&&(this.page+=1)},setSearch(e){this.filters.search=e??"",this.page=1},setJobs(e){this.filters.jobs=Array.isArray(e)?e:[],this.page=1},setUniq(e){this.filters.uniq=!!e,this.page=1},setTypes(e){this.filters.types=Array.isArray(e)?e:[],this.page=1},setLabels(e){this.filters.labels=Array.isArray(e)?e:[],this.page=1},setPositions(e){this.filters.positions=Array.isArray(e)?e:[],this.page=1},setPositionsUniq(e){this.filters.positionsUniq=!!e,this.page=1},setSkillId(e){const s=e==null||e===""?null:Number(e);this.filters.hasSkillId=Number.isFinite(s)?s:null,this.page=1},setSort(e,s){this.sort.by=e||this.sort.by,this.sort.dir=s||this.sort.dir,this.page=1},setPage(e){this.page=Math.max(1,Number(e||1))},setPageSize(e){this.pageSize=Math.min(200,Math.max(5,Number(e||30))),this.page=1},resetFilters(){this.filters={search:"",jobs:[],uniq:!1,types:[],positions:[],positionsUniq:!1,labels:[],hasSkillId:null},this.page=1}}}),ze={class:"space-y-7 pb-8"},Be={class:"filter-card"},Ue={class:"flex items-center justify-between gap-4"},Fe={class:"inline-flex items-center gap-2 cursor-pointer select-none text-xs"},Pe=["checked"],Oe={class:"tiles-grid"},Re=["checked","onChange"],Ve={class:"tile-label"},De={class:"mt-3 text-xs leading-relaxed text-white/70"},Je={key:0,class:"filter-card"},He={class:"flex items-center justify-between gap-4"},Ee={class:"text-xs text-white/50"},Ke={class:"tiles-grid"},Ge=["checked","onChange"],Qe={class:"tile-label"},Xe={class:"filter-card"},Ye={class:"flex items-center justify-between gap-4"},Ze={class:"inline-flex items-center gap-2 cursor-pointer select-none text-xs"},es=["checked"],ss={class:"tiles-grid"},ts=["checked","onChange"],is={class:"tile-label"},ls={class:"mt-3 text-xs leading-relaxed text-white/70"},ns={__name:"WikiWeaponFilterPanel",props:{open:{type:Boolean,default:!1},locale:{type:String,default:"en"},jobs:{type:Array,default:()=>[]},labels:{type:Array,default:()=>[]},positions:{type:Array,default:()=>[]},positionsUniq:{type:Boolean,default:!1},uniq:{type:Boolean,default:!1}},emits:["close","reset","update:jobs","update:labels","update:positions","update:positions-uniq","update:uniq"],setup(e,{emit:s}){const d=e,r=s,f=le(),o=ne(),p=g=>f.load(g);se(()=>p(d.locale)),O(()=>d.locale,g=>p(g));const m=[{label:"Striker",value:1},{label:"Keystone",value:2},{label:"Buster",value:4},{label:"Bullseye",value:8},{label:"Apostle",value:16}],h=[{label:"Body",value:64},{label:"Bag L",value:128},{label:"Bag R",value:256},{label:"Arm L",value:512},{label:"Arm R",value:1024},{label:"Shoulder L",value:2048},{label:"Shoulder R",value:4096}],_=S(()=>o.facets?.labels||[]),L=S(()=>{const g=Array.isArray(_.value)?_.value:[];if(!g.length)return[];const t=[],b=f.byId||{},T=d.locale;for(const M of g){const $=b[M];$&&t.push({value:$.ID,label:$.i18n?.[T]||$.Name?.text||String($.ID),color:$.LabelImageColor||"5E5E5E"})}return t.sort((M,$)=>M.label.localeCompare($.label)),t}),k=(g,t)=>{const b=new Set(g==="jobs"?d.jobs:g==="labels"?d.labels:g==="positions"?d.positions:[]);b.has(t)?b.delete(t):b.add(t);const T=Array.from(b);g==="jobs"&&r("update:jobs",T),g==="labels"&&r("update:labels",T),g==="positions"&&r("update:positions",T)},c=S(()=>(d.jobs?.length||0)+(d.labels?.length||0)+(d.positions?.length||0)+(d.positionsUniq?1:0)+(d.uniq?1:0));function y(){r("update:jobs",[]),r("update:labels",[]),r("update:positions",[]),r("update:positions-uniq",!1),r("update:uniq",!1),r("reset")}const u=(g,t)=>Array.isArray(g)&&g.includes(t);return(g,t)=>(v(),te(Le,{open:e.open,title:"Weapons scope",count:c.value,onClose:t[2]||(t[2]=b=>g.$emit("close")),onReset:y},{default:ie(()=>[i("div",ze,[i("section",Be,[i("div",Ue,[t[4]||(t[4]=i("h4",{class:"sec-title"},"Jobs",-1)),i("label",Fe,[i("input",{type:"checkbox",class:"accent-[#63B4C8]",checked:e.uniq,onChange:t[0]||(t[0]=b=>g.$emit("update:uniq",b.target.checked))},null,40,Pe),t[3]||(t[3]=i("span",{class:"opacity-80"},"Unique only",-1))])]),i("div",Oe,[(v(),x(N,null,j(m,b=>i("label",{key:"jobs-"+b.value,class:B(["tile",{"is-active":u(e.jobs,b.value)}])},[i("input",{type:"checkbox",class:"sr-only",checked:e.jobs.includes(b.value),onChange:T=>k("jobs",b.value)},null,40,Re),i("span",Ve,C(b.label),1)],2)),64))]),i("p",De,[e.uniq?(v(),x(N,{key:0},[t[5]||(t[5]=q(" Shows only weapons available to ",-1)),t[6]||(t[6]=i("b",null,"exactly one",-1)),t[7]||(t[7]=q(" class or the ",-1)),t[8]||(t[8]=i("b",null,"combination",-1)),t[9]||(t[9]=q(" of the selected classes. ",-1))],64)):(v(),x(N,{key:1},[t[10]||(t[10]=q(" A weapon matches if it's available to ",-1)),t[11]||(t[11]=i("i",null,"any",-1)),t[12]||(t[12]=q(" of the selected classes. ",-1))],64))])]),L.value.length?(v(),x("section",Je,[i("div",He,[t[13]||(t[13]=i("h4",{class:"sec-title"},"Labels",-1)),i("span",Ee,C(L.value.length)+" tags",1)]),i("div",Ke,[(v(!0),x(N,null,j(L.value,b=>(v(),x("label",{key:`label-${b.value}`,class:B(["tile",{"is-active":u(e.labels,b.value)}]),style:ke({"--tile-accent":`#${b.color}`})},[i("input",{type:"checkbox",class:"sr-only",checked:e.labels.includes(b.value),onChange:T=>k("labels",b.value)},null,40,Ge),i("span",Qe,C(b.label),1)],6))),128))])])):U("",!0),i("section",Xe,[i("div",Ye,[t[15]||(t[15]=i("h4",{class:"sec-title"},"Weapon Slots",-1)),i("label",Ze,[i("input",{type:"checkbox",class:"accent-[#63B4C8]",checked:e.positionsUniq,onChange:t[1]||(t[1]=b=>g.$emit("update:positions-uniq",b.target.checked))},null,40,es),t[14]||(t[14]=i("span",{class:"opacity-80"},"Unique only",-1))])]),i("div",ss,[(v(),x(N,null,j(h,b=>i("label",{key:"pos-"+b.value,class:B(["tile",{"is-active":u(e.positions,b.value)}])},[i("input",{type:"checkbox",class:"sr-only",checked:e.positions.includes(b.value),onChange:T=>k("positions",b.value)},null,40,ts),i("span",is,C(b.label),1)],2)),64))]),i("p",ls,[e.positionsUniq?(v(),x(N,{key:0},[t[16]||(t[16]=q(" Shows only weapons whose slot mask matches ",-1)),t[17]||(t[17]=i("b",null,"exactly",-1)),t[18]||(t[18]=q(" the selected flags. ",-1))],64)):(v(),x(N,{key:1},[t[19]||(t[19]=q(" A weapon matches if its slot mask contains ",-1)),t[20]||(t[20]=i("i",null,"any",-1)),t[21]||(t[21]=q(" of the selected flags. ",-1))],64))])])])]),_:1},8,["open","count"]))}},as=H(ns,[["__scopeId","data-v-c557cfe4"]]),Z={by:"id",dir:"asc"},ae=ee("wikiSkill",{state:()=>({items:[],count:0,loading:!1,error:"",loadedLocale:"en",filters:{search:"",levels:[],damageTypes:[],weaponTypes:[],tips:[],hasBuffId:null,cooldownMax:null,costMax:null},sort:{...Z},page:1,pageSize:30,rawText:""}),getters:{makeLocalizers:()=>e=>({nameOf:s=>s?.i18n?.name?.[e]??s?.englishName??"",descOf:s=>s?.i18n?.desc?.[e]??""}),facets(e){const s=new Set,d=new Set,r=new Set;for(const f of e.items)f.Skill_LV!=null&&s.add(f.Skill_LV),f.Damage_Type!=null&&d.add(f.Damage_Type),f.WeaponTypeLimit!=null&&r.add(f.WeaponTypeLimit);return{levels:Array.from(s).sort((f,o)=>f-o),damageTypes:Array.from(d).sort((f,o)=>f-o),weaponTypes:Array.from(r).sort((f,o)=>f-o)}},filtered(e){const s=e.filters,d=(s.search||"").trim().toLowerCase(),r=new Set(s.levels||[]),f=new Set(s.damageTypes||[]),o=new Set(s.weaponTypes||[]),p=new Set(s.tips||[]),m=s.hasBuffId,h=Number.isFinite(s.cooldownMax)?Number(s.cooldownMax):null,_=Number.isFinite(s.costMax)?Number(s.costMax):null,{nameOf:L,descOf:k}=this.makeLocalizers(e.loadedLocale);return e.items.filter(c=>{if(r.size&&!r.has(c.Skill_LV)||f.size&&!f.has(c.Damage_Type)||o.size&&!o.has(c.WeaponTypeLimit)||p.size&&!(Array.isArray(c.Tips_Label)?c.Tips_Label:[]).some(g=>p.has(g))||m!=null&&!(Array.isArray(c.Buff_Display)?c.Buff_Display:[]).some(u=>u?.BuffId===Number(m))||h!=null&&Number(c.Cooldown??0)>h||_!=null&&Number(c.SkillCost??0)>_)return!1;if(d){const y=(L(c)||"").toLowerCase(),u=(k(c)||"").toLowerCase(),g=(c.englishName||"").toLowerCase();if(!(y.includes(d)||u.includes(d)||g.includes(d)))return!1}return!0})},sorted(){const e=[...this.filtered],{by:s,dir:d}=this.sort,r=d==="desc"?-1:1,{nameOf:f}=this.makeLocalizers(this.loadedLocale);return e.sort((o,p)=>{let m,h;switch(s){case"CombatPower":m=o.CombatPower,h=p.CombatPower;break;case"Cooldown":m=o.Cooldown,h=p.Cooldown;break;case"Skill_LV":m=o.Skill_LV,h=p.Skill_LV;break;case"name":m=f(o),h=f(p);break;default:m=o.id,h=p.id;break}return m==null&&h==null?0:m==null?-1*r:h==null?1*r:typeof m=="string"&&typeof h=="string"?m.localeCompare(h)*r:(m===h?0:m<h?-1:1)*r}),e},pageItems(){const e=this.page*this.pageSize;return this.sorted.slice(0,e)},filteredTotal(){return this.sorted.length},hasNextPage(){return this.page*this.pageSize<this.filteredTotal},totalPages(){return Math.max(1,Math.ceil(this.sorted.length/this.pageSize))}},actions:{async load(e="en"){this.loadedLocale!==e&&(this.page=1,this.sort={...Z},this.filters.search=""),this.loading=!0,this.error="",this.rawText="";try{const{data:s}=await We(e);this.items=Array.isArray(s?.skills)?s.skills:[],this.count=Number(s?.count||this.items.length||0),this.loadedLocale=e,this.rawText=JSON.stringify(s,null,2)}catch(s){this.error=s?.response?.data?.detail||s?.message||"Request failed",this.items=[],this.count=0}finally{this.loading=!1}},applyFilters(e={}){if("search"in e&&(this.filters.search=e.search??""),"levels"in e&&(this.filters.levels=Array.isArray(e.levels)?e.levels:[]),"damageTypes"in e&&(this.filters.damageTypes=Array.isArray(e.damageTypes)?e.damageTypes:[]),"weaponTypes"in e&&(this.filters.weaponTypes=Array.isArray(e.weaponTypes)?e.weaponTypes:[]),"tips"in e&&(this.filters.tips=Array.isArray(e.tips)?e.tips:[]),"hasBuffId"in e){const s=e.hasBuffId;this.filters.hasBuffId=s==null||s===""?null:Number(s)}if("cooldownMax"in e){const s=Number(e.cooldownMax);this.filters.cooldownMax=Number.isFinite(s)?s:null}if("costMax"in e){const s=Number(e.costMax);this.filters.costMax=Number.isFinite(s)?s:null}this.page=1},nextPage(){this.hasNextPage&&(this.page+=1)},setPage(e){this.page=Math.max(1,Number(e||1))},setPageSize(e){this.pageSize=Math.min(200,Math.max(5,Number(e||30))),this.page=1},setSort(e,s){this.sort.by=e||this.sort.by,this.sort.dir=s||this.sort.dir,this.page=1},setSearch(e){this.filters.search=e??"",this.page=1},setLevels(e){this.filters.levels=Array.isArray(e)?e:[],this.page=1},setDamageTypes(e){this.filters.damageTypes=Array.isArray(e)?e:[],this.page=1},setWeaponTypes(e){this.filters.weaponTypes=Array.isArray(e)?e:[],this.page=1},setTips(e){this.filters.tips=Array.isArray(e)?e:[],this.page=1},setBuffId(e){this.filters.hasBuffId=e==null||e===""?null:Number(e),this.page=1},setCooldownMax(e){this.filters.cooldownMax=Number.isFinite(+e)?+e:null,this.page=1},setCostMax(e){this.filters.costMax=Number.isFinite(+e)?+e:null,this.page=1},resetFilters(){this.filters={search:"",levels:[],damageTypes:[],weaponTypes:[],tips:[],hasBuffId:null,cooldownMax:null,costMax:null},this.page=1}}}),os={class:"weapon-card"},rs={class:"hero"},us={class:"hero-art"},cs=["src","alt"],ds={class:"hero-copy"},fs={key:0,class:"section-block"},ps=["innerHTML"],ms={key:1,class:"section-block"},hs=["src"],bs={class:"skill-copy"},gs=["innerHTML"],ys=["innerHTML"],vs={__name:"WikiWeaponCard",props:{weapon:{type:Object,required:!0},locale:{type:String,default:"en"}},setup(e){const s=e,d=ae(),r=Te();function f(c,y){const u=r.byId?.[c];return u&&(u.Buff_LV==null||Number(u.Buff_LV)===Number(y))?u:(Array.isArray(r.items)?r.items:[]).find(t=>t.id===c&&Number(t.Buff_LV)===Number(y))||u||null}const o=S(()=>String(s.locale||"en")),p=_e({locale:o.value,findBuff:f});se(()=>{d.items?.length||d.load(o.value),r.items?.length||r.load(o.value)}),O(o,c=>{d.load(c),r.load(c),p.setLocale?.(c)});const m=S(()=>s.weapon?.i18n?.name?.[o.value]||s.weapon?.englishName||`Weapon #${s.weapon?.id}`),h=S(()=>{const c=s.weapon?.i18n?.desc?.[o.value]||"";return p.format(c,s.weapon?.Upgrade_Value||[])}),_=S(()=>`/wiki/Weapons/${s.weapon?.Icon}.png`),L=S(()=>{const c=Object.create(null);for(const y of d.items||[])c[y.id]=y;return c}),k=S(()=>(Array.isArray(s.weapon?.skills)?s.weapon.skills:[]).map(y=>{const u=L.value[y];if(!u)return null;const g=Array.isArray(u.Upgrade_Value)?u.Upgrade_Value:[],t=u?.i18n?.name?.[o.value]||u?.englishName||`Skill ${u.id}`,b=u?.i18n?.desc?.[o.value]||"";return{id:u.id,icon:`/wiki/Skills/${u?.Icon||"Icon_Skill_10001"}.png`,nameHtml:p.format(t,g),descHtml:p.format(b,g)}}).filter(Boolean));return(c,y)=>(v(),x("article",os,[i("div",rs,[i("div",us,[y[0]||(y[0]=i("img",{src:J,alt:"",class:"hero-bg","aria-hidden":"true",draggable:"false"},null,-1)),i("img",{src:_.value,alt:m.value,class:"hero-weapon",loading:"lazy",draggable:"false"},null,8,cs)]),i("div",ds,[y[1]||(y[1]=i("p",{class:"eyebrow"},"Weapon module",-1)),i("h2",null,C(m.value),1)])]),h.value?(v(),x("section",fs,[y[2]||(y[2]=i("h3",{class:"section-title"},"Overview",-1)),i("div",{class:"richtext text-base leading-relaxed",innerHTML:h.value},null,8,ps)])):U("",!0),k.value.length?(v(),x("section",ms,[y[3]||(y[3]=i("h3",{class:"section-title"},"Skills",-1)),(v(!0),x(N,null,j(k.value,u=>(v(),x("div",{class:"skill-card",key:u.id},[i("img",{src:u.icon,alt:"",loading:"lazy"},null,8,hs),i("div",bs,[i("div",{class:"richtext skill-name",innerHTML:u.nameHtml},null,8,gs),i("div",{class:"richtext skill-desc",innerHTML:u.descHtml},null,8,ys)])]))),128))])):U("",!0)]))}},ks=H(vs,[["__scopeId","data-v-79ed0336"]]),xs={class:"mx-auto w-full max-w-[98vw] px-2 sm:px-4 lg:px-6 space-y-4"},ws={class:"space-y-3"},As={class:"flex items-center justify-between"},Ss=["onClick","title"],Ls=["src"],Ts={class:"relative z-10 text-xs font-semibold uppercase tracking-[0.3em] text-white/70"},_s={class:"flex flex-wrap items-center gap-3"},qs={class:"order-1 sm:order-1"},Ns={class:"order-2 sm:order-3 ml-auto text-sm opacity-80 flex items-center gap-2"},$s={class:"font-medium"},Cs={class:"order-4 sm:order-2 basis-full sm:basis-auto w-full sm:w-auto sm:flex-1 flex items-center gap-3"},Ms={class:"relative flex-1 min-w-[240px]"},js={key:0,class:"text-sm opacity-80"},Is={key:1,class:"text-sm text-red-400"},Ws={key:2},zs={class:"hidden sm:grid gap-4 grid-cols-[repeat(auto-fill,minmax(200px,1fr))]"},Bs=["onClick","title"],Us={class:"absolute inset-0"},Fs=["src"],Ps={class:"absolute bottom-0 left-0 right-0 px-2 py-1 text-[11px] bg-black/40 backdrop-blur-sm"},Os={class:"flex items-center justify-center text-center"},Rs={class:"opacity-90 text-sm font-medium truncate max-w-[90%]"},Vs={class:"flex flex-col gap-3 sm:hidden"},Ds=["onClick"],Js={class:"mobile-art"},Hs=["src"],Es={class:"mobile-copy"},Ks={class:"mobile-title"},Gs={__name:"weapons",setup(e){const s=ne(),d=ae(),r=le();xe({title:"Wiki â€” Weapons"});async function f(a=o.value){const l=a??o.value;await Promise.all([s.load(l),d.load(l),r.load(l)]),M()}const{locale:o,search:p,isMobile:m,showFilterPanel:h,modalOpen:_,toggleFilterPanel:L,setFilterPanelOpen:k,setModalOpen:c}=qe({initialLocale:"en",loadResources:f,onSearchChange:()=>{s.page=1}}),y=Ne("All Weapons"),u=D(0);function g(a){u.value=a;const l={...t.value,jobs:a===0?[]:[a],uniq:!1};t.value=l}const t=D({rares:[],jobs:[],labels:[],uniq:!1});function b(a={}){return{rares:[],jobs:Array.isArray(a.jobs)?[...a.jobs]:[],labels:Array.isArray(a.labels)?[...a.labels]:[],positions:Array.isArray(a.positions)?[...a.positions]:[],positionsUniq:!!a.positionsUniq,uniq:!!a.uniq}}t.value=b();let T=!1;function M(){T=!0,t.value=b(s.filters||{}),T=!1;const a=Array.isArray(t.value.jobs)?t.value.jobs:[];u.value=a.length===1?a[0]:0}M();const $=S(()=>{const a=Object.create(null),l=t.value.labels||[],n=o.value;for(const A of l){const I=r.byId?.[A];I&&(a[A]={id:A,text:I.i18n?.[n]||I.Name?.text||String(A),colorHex:I.LabelImageColor||"5E5E5E"})}return a});O(()=>t.value.jobs,a=>{const l=Array.isArray(a)?a:[];u.value=l.length===1?l[0]:0});function oe(){p.value="",s.resetFilters(),M()}function re(){p.value="",s.resetFilters(),M()}const ue=S(()=>{const a=Object.create(null);for(const l of d.items||[])a[l.id]=l;return a}),R=S(()=>String(p.value||"").trim().toLowerCase()),W=a=>String(a||"").toLowerCase();function ce(a){if(!R.value)return!0;const l=R.value,n=String(o.value||"en"),A=W(a?.englishName),I=W(a?.i18n?.name?.[n]),he=W(a?.i18n?.desc?.[n]);if(A.includes(l)||I.includes(l)||he.includes(l))return!0;const be=Array.isArray(a?.skills)?a.skills:[];for(const ge of be){const P=ue.value?.[ge];if(!P)continue;const ye=W(P?.i18n?.name?.[n]||P?.englishName),ve=W(P?.i18n?.desc?.[n]);if(ye.includes(l)||ve.includes(l))return!0}return!1}const V=S(()=>{const a=s.sorted;return Array.isArray(a)?R.value?a.filter(ce):a:[]}),E=S(()=>V.value.slice(0,s.page*s.pageSize)),de=S(()=>V.value.length),K=S(()=>s.page*s.pageSize<V.value.length),fe=S(()=>s.loading);function pe(){K.value&&s.nextPage()}function G(a){return`/wiki/Weapons/${a?.Icon||"weapon_unknown"}.png`}const F=D(null);function Q(a){F.value=a,c(!0)}function me(){c(!1),F.value=null}return O(t,a=>{T||s.applyFilters({jobs:Array.isArray(a.jobs)?[...a.jobs]:[],labels:Array.isArray(a.labels)?[...a.labels]:[],positions:Array.isArray(a.positions)?[...a.positions]:[],positionsUniq:!!a.positionsUniq,uniq:!!a.uniq})},{deep:!0}),(a,l)=>(v(),x("section",xs,[i("header",ws,[i("div",As,[l[16]||(l[16]=i("h1",{class:"text-2xl font-semibold"},"Wiki - Weapons",-1)),z($e,{modelValue:w(o),"onUpdate:modelValue":l[0]||(l[0]=n=>X(o)?o.value=n:null)},null,8,["modelValue"])]),i("div",{class:B(["grid gap-3",w(m)?"grid-cols-3":"grid-cols-6"])},[(v(!0),x(N,null,j(w(y),n=>(v(),x("button",{key:n.id,class:B(["job-card group",[w(m)?"h-24":"h-28",u.value===n.id?"is-active":""]]),onClick:A=>g(n.id),title:n.label},[i("img",{src:n.img,class:"absolute inset-0 h-full w-full object-cover opacity-90",alt:""},null,8,Ls),l[17]||(l[17]=i("div",{class:"absolute inset-0",style:{"background-image":"url('/wiki/Mechs/Img_BigScreenBG.png')","background-size":"cover",opacity:".25"}},null,-1)),l[18]||(l[18]=i("div",{class:"absolute inset-0 bg-gradient-to-br from-black/70 via-black/40 to-transparent transition-opacity group-hover:opacity-60"},null,-1)),i("span",Ts,C(n.label),1)],10,Ss))),128))],2),i("div",_s,[i("div",qs,[i("button",{onClick:l[1]||(l[1]=(...n)=>w(L)&&w(L)(...n)),class:"filter-toggle"},[...l[19]||(l[19]=[i("img",{src:Se,class:"w-5 sm:w-6",alt:"filter"},null,-1),q(" Filters ",-1)])])]),i("div",Ns,[l[21]||(l[21]=i("span",{class:"inline-block w-2 h-2 rounded-full bg-emerald-400 animate-pulse"},null,-1)),i("span",null,[l[20]||(l[20]=q("Items: ",-1)),i("span",$s,C(de.value),1)])]),i("div",Cs,[i("div",Ms,[we(i("input",{"onUpdate:modelValue":l[2]||(l[2]=n=>X(p)?p.value=n:null),type:"text",inputmode:"search",placeholder:"Search by name or description...",class:"search-input"},null,512),[[Ae,w(p),void 0,{trim:!0}]]),l[23]||(l[23]=i("svg",{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 opacity-70",viewBox:"0 0 24 24",fill:"currentColor"},[i("path",{d:"M10 4a6 6 0 104.472 10.028l4.25 4.25 1.414-1.414-4.25-4.25A6 6 0 0010 4zm-4 6a4 4 0 118 0 4 4 0 01-8 0z"})],-1)),w(p)?(v(),x("button",{key:0,onClick:l[3]||(l[3]=n=>p.value=""),class:"absolute right-2.5 top-1/2 grid h-6 w-6 -translate-y-1/2 place-items-center rounded-full bg-white/5 text-white/70 transition hover:bg-white/15",title:"Clear"},[...l[22]||(l[22]=[i("svg",{class:"w-3.5 h-3.5 opacity-80",viewBox:"0 0 24 24",fill:"currentColor"},[i("path",{d:"M6.225 4.811L4.811 6.225 9.586 11l-4.775 4.775 1.414 1.414L11 12.414l4.775 4.775 1.414-1.414L12.414 11l4.775-4.775-1.414-1.414L11 9.586z"})],-1)])])):U("",!0)]),i("button",{onClick:oe,class:"ghost-btn shrink-0"}," Reload ")])])]),z(Ce,{locale:w(o),rares:t.value.rares,jobs:t.value.jobs,labels:t.value.labels,positions:t.value.positions,"positions-uniq":t.value.positionsUniq,uniq:t.value.uniq,"label-map":$.value,"onRemove:rarity":l[4]||(l[4]=n=>t.value.rares=t.value.rares.filter(A=>A!==n)),"onRemove:job":l[5]||(l[5]=n=>t.value.jobs=t.value.jobs.filter(A=>A!==n)),"onRemove:label":l[6]||(l[6]=n=>t.value.labels=t.value.labels.filter(A=>A!==n)),"onRemove:position":l[7]||(l[7]=n=>t.value.positions=t.value.positions.filter(A=>A!==n)),"onUnset:positionsUniq":l[8]||(l[8]=n=>t.value.positionsUniq=!1),"onUnset:uniq":l[9]||(l[9]=n=>t.value.uniq=!1)},null,8,["locale","rares","jobs","labels","positions","positions-uniq","uniq","label-map"]),w(s).loading?(v(),x("div",js,"Loading...")):w(s).error?(v(),x("div",Is,"Error: "+C(w(s).error),1)):(v(),x("div",Ws,[i("div",zs,[(v(!0),x(N,null,j(E.value,n=>(v(),x("button",{key:n.id,onClick:A=>Q(n),class:"wiki-card group",title:n.i18n?.name?.[w(o)]||n.englishName||`ID ${n.id}`},[i("div",Us,[i("img",{src:G(n),class:"absolute inset-0 w-full h-full object-contain z-10",alt:"",draggable:"false",loading:"lazy"},null,8,Fs),l[24]||(l[24]=i("img",{src:J,alt:"",class:"absolute inset-0 w-full h-full object-cover opacity-75",draggable:"false"},null,-1))]),i("div",Ps,[i("div",Os,[i("span",Rs,C(n.i18n?.name?.[w(o)]||n.englishName||`ID ${n.id}`),1)])])],8,Bs))),128))]),i("div",Vs,[(v(!0),x(N,null,j(E.value,n=>(v(),x("button",{key:`mobile-${n.id}`,onClick:A=>Q(n),class:"wiki-card-mobile"},[i("div",Js,[l[25]||(l[25]=i("img",{src:J,alt:"",class:"mobile-bg","aria-hidden":"true",draggable:"false"},null,-1)),i("img",{src:G(n),alt:"",class:"mobile-thumb",loading:"lazy",draggable:"false"},null,8,Hs)]),i("div",Es,[i("p",Ks,C(n.i18n?.name?.[w(o)]||n.englishName||`ID ${n.id}`),1)])],8,Ds))),128))]),z(Me,{"is-loading":fe.value,"has-next-page":K.value,onLoadMore:pe},null,8,["is-loading","has-next-page"])])),z(je,{open:w(_),mobile:w(m),"aria-label":"Weapon details",onClose:me},{default:ie(()=>[F.value?(v(),te(ks,{key:0,weapon:F.value,locale:w(o)},null,8,["weapon","locale"])):U("",!0)]),_:1},8,["open","mobile"]),z(as,{open:w(h),locale:w(o),jobs:t.value.jobs,"onUpdate:jobs":l[10]||(l[10]=n=>t.value.jobs=n),labels:t.value.labels,"onUpdate:labels":l[11]||(l[11]=n=>t.value.labels=n),positions:t.value.positions,"onUpdate:positions":l[12]||(l[12]=n=>t.value.positions=n),"positions-uniq":t.value.positionsUniq,"onUpdate:positionsUniq":l[13]||(l[13]=n=>t.value.positionsUniq=n),uniq:t.value.uniq,"onUpdate:uniq":l[14]||(l[14]=n=>t.value.uniq=n),onClose:l[15]||(l[15]=()=>w(k)(!1)),onReset:re},null,8,["open","locale","jobs","labels","positions","positions-uniq","uniq"])]))}},et=H(Gs,[["__scopeId","data-v-3b1df5e3"]]);export{et as default};
