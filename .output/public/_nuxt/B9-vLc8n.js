import{f as T,K as q,L as z,m as F,M as G,N as Q,O as X,s as M,P as R,Q as J,G as Y,R as Z,h as E,S as k,U as K,V as aa,W as ea,X as ta,_ as U,i as W,o as p,w as na,a as m,t as N,l as sa,c as C,F as I,r as j}from"./BXlpFhld.js";import{_ as ra}from"./D-KUjpX5.js";import{c as B}from"./kT4pw4b7.js";import{f as oa}from"./QzWGY4mI.js";const ia={trailing:!0};function ca(a,t=25,r={}){if(r={...ia,...r},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let o,n,f=[],s,e;const h=(d,D)=>(s=la(a,d,D),s.finally(()=>{if(s=null,r.trailing&&e&&!n){const g=h(d,e);return e=null,g}}),s),v=function(...d){return r.trailing&&(e=d),s||new Promise(D=>{const g=!n&&r.leading;clearTimeout(n),n=setTimeout(()=>{n=null;const c=r.leading?o:h(this,d);e=null;for(const _ of f)_(c);f=[]},t),g?(o=h(this,d),D(o)):f.push(D)})},i=d=>{d&&(clearTimeout(d),n=null)};return v.isPending=()=>!!n,v.cancel=()=>{i(n),f=[],e=null},v.flush=()=>{if(i(n),!e||s)return;const d=e;return e=null,h(this,d)},v}async function la(a,t,r){return await a.apply(t,r)}const ua=Symbol.for("nuxt:client-only");function La(...a){const t=typeof a[a.length-1]=="string"?a.pop():void 0;da(a[0],a[1])&&a.unshift(t);let[r,o,n={}]=a,f=!1;const s=T(()=>Q(r));if(typeof s.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const e=q();n.server??=!0,n.default??=_a,n.getCachedData??=A,n.lazy??=!1,n.immediate??=!0,n.deep??=z.deep,n.dedupe??="cancel",n._functionName,e._asyncData[s.value];function h(){const c={cause:"initial",dedupe:n.dedupe};return e._asyncData[s.value]?._init||(c.cachedData=n.getCachedData(s.value,e,{cause:"initial"}),e._asyncData[s.value]=V(e,s.value,o,n,c.cachedData)),()=>e._asyncData[s.value].execute(c)}const v=h(),i=e._asyncData[s.value];i._deps++;const d=n.server!==!1&&e.payload.serverRendered;{let c=function(u){const l=e._asyncData[u];l?._deps&&(l._deps--,l._deps===0&&l?._off())};const _=k();if(_&&d&&n.immediate&&!_.sp&&(_.sp=[]),_&&!_._nuxtOnBeforeMountCbs){_._nuxtOnBeforeMountCbs=[];const u=_._nuxtOnBeforeMountCbs;K(()=>{u.forEach(l=>{l()}),u.splice(0,u.length)}),aa(()=>u.splice(0,u.length))}const P=_&&(_._nuxtClientOnly||ea(ua,!1));d&&e.isHydrating&&(i.error.value||i.data.value!==void 0)?i.status.value=i.error.value?"error":"success":_&&(!P&&e.payload.serverRendered&&e.isHydrating||n.lazy)&&n.immediate?_._nuxtOnBeforeMountCbs.push(v):n.immediate&&i.status.value!=="success"&&v();const b=X(),y=F(s,(u,l)=>{if((u||l)&&u!==l){f=!0;const x=e._asyncData[l]?.data.value!==void 0,H=e._asyncDataPromises[l]!==void 0,L={cause:"initial",dedupe:n.dedupe};if(!e._asyncData[u]?._init){let O;l&&x?O=e._asyncData[l].data.value:(O=n.getCachedData(u,e,{cause:"initial"}),L.cachedData=O),e._asyncData[u]=V(e,u,o,n,O)}e._asyncData[u]._deps++,l&&c(l),(n.immediate||x||H)&&e._asyncData[u].execute(L),ta(()=>{f=!1})}},{flush:"sync"}),w=n.watch?F(n.watch,()=>{f||i._execute({cause:"watch",dedupe:n.dedupe})}):()=>{};b&&G(()=>{y(),w(),c(s.value)})}const D={data:S(()=>e._asyncData[s.value]?.data),pending:S(()=>e._asyncData[s.value]?.pending),status:S(()=>e._asyncData[s.value]?.status),error:S(()=>e._asyncData[s.value]?.error),refresh:(...c)=>e._asyncData[s.value]?._init?e._asyncData[s.value].execute(...c):h()(),execute:(...c)=>D.refresh(...c),clear:()=>{const c=e._asyncData[s.value];if(c?._abortController)try{c._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{c._abortController=void 0}$(e,s.value)}},g=Promise.resolve(e._asyncDataPromises[s.value]).then(()=>D);return Object.assign(g,D),g}function S(a){return T({get(){return a()?.value},set(t){const r=a();r&&(r.value=t)}})}function da(a,t){return!(typeof a=="string"||typeof a=="object"&&a!==null||typeof a=="function"&&typeof t=="function")}function $(a,t){t in a.payload.data&&(a.payload.data[t]=void 0),t in a.payload._errors&&(a.payload._errors[t]=void 0),a._asyncData[t]&&(a._asyncData[t].data.value=E(a._asyncData[t]._default()),a._asyncData[t].error.value=void 0,a._asyncData[t].status.value="idle"),t in a._asyncDataPromises&&(a._asyncDataPromises[t]=void 0)}function fa(a,t){const r={};for(const o of t)r[o]=a[o];return r}function V(a,t,r,o,n){a.payload._errors[t]??=void 0;const f=o.getCachedData!==A,s=r,e=o.deep?M:R,h=n!==void 0,v=a.hook("app:data:refresh",async d=>{(!d||d.includes(t))&&await i.execute({cause:"refresh:hook"})}),i={data:e(h?n:o.default()),pending:T(()=>i.status.value==="pending"),error:J(a.payload._errors,t),status:R("idle"),execute:(...d)=>{const[D,g=void 0]=d,c=D&&g===void 0&&typeof D=="object"?D:{};if(a._asyncDataPromises[t]&&(c.dedupe??o.dedupe)==="defer")return a._asyncDataPromises[t];{const b="cachedData"in c?c.cachedData:o.getCachedData(t,a,{cause:c.cause??"refresh:manual"});if(b!==void 0)return a.payload.data[t]=i.data.value=b,i.error.value=void 0,i.status.value="success",Promise.resolve(b)}i._abortController&&i._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),i._abortController=new AbortController,i.status.value="pending";const _=new AbortController,P=new Promise((b,y)=>{try{const w=c.timeout??o.timeout,u=va([i._abortController?.signal,c?.signal],_.signal,w);if(u.aborted){const l=u.reason;y(l instanceof Error?l:new DOMException(String(l??"Aborted"),"AbortError"));return}return u.addEventListener("abort",()=>{const l=u.reason;y(l instanceof Error?l:new DOMException(String(l??"Aborted"),"AbortError"))},{once:!0,signal:_.signal}),Promise.resolve(s(a,{signal:u})).then(b,y)}catch(w){y(w)}}).then(async b=>{let y=b;o.transform&&(y=await o.transform(b)),o.pick&&(y=fa(y,o.pick)),a.payload.data[t]=y,i.data.value=y,i.error.value=void 0,i.status.value="success"}).catch(b=>{if(!(a._asyncDataPromises[t]&&a._asyncDataPromises[t]!==P)&&!i._abortController?.signal.aborted){if(typeof DOMException<"u"&&b instanceof DOMException&&b.name==="AbortError"){i.status.value="idle";return}i.error.value=Z(b),i.data.value=E(o.default()),i.status.value="error"}}).finally(()=>{_.abort(),delete a._asyncDataPromises[t]});return a._asyncDataPromises[t]=P,a._asyncDataPromises[t]},_execute:ca((...d)=>i.execute(...d),0,{leading:!0}),_default:o.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{v(),a._asyncData[t]?._init&&(a._asyncData[t]._init=!1),f||Y(()=>{a._asyncData[t]?._init||($(a,t),i.execute=()=>Promise.resolve())})}};return i}const _a=()=>{},A=(a,t,r)=>{if(t.isHydrating)return t.payload.data[a];if(r.cause!=="refresh:manual"&&r.cause!=="refresh:hook")return t.static.data[a]};function va(a,t,r){const o=a.filter(s=>!!s);if(typeof r=="number"&&r>=0){const s=AbortSignal.timeout?.(r);s&&o.push(s)}if(AbortSignal.any)return AbortSignal.any(o);const n=new AbortController;for(const s of o)if(s.aborted){const e=s.reason??new DOMException("Aborted","AbortError");try{n.abort(e)}catch{n.abort()}return n.signal}const f=()=>{const e=o.find(h=>h.aborted)?.reason??new DOMException("Aborted","AbortError");try{n.abort(e)}catch{n.abort()}};for(const s of o)s.addEventListener?.("abort",f,{once:!0,signal:t});return n.signal}const ba={class:"content"},ma={class:"name"},ha={class:"metrics"},Da={class:"metric"},ya={class:"value"},ga={class:"metric"},pa={class:"value"},Ca={class:"art"},Ea=["src","alt"],wa={__name:"CollectionsBannerItem",props:{bannerName:String,bannerData:Object},setup(a){return(t,r)=>{const o=ra;return p(),W(o,{to:E(B)[a.bannerName].banner.link_to,class:"banner-card"},{default:na(()=>[m("div",ba,[r[2]||(r[2]=m("p",{class:"eyebrow"},"Collection Insight",-1)),m("h3",ma,N(E(B)[a.bannerName].banner.name),1),m("div",ha,[m("div",Da,[r[0]||(r[0]=m("span",{class:"label"},"Floor price",-1)),m("span",ya,N(a.bannerData.min_price??"â€”")+" USD",1)]),m("div",ga,[r[1]||(r[1]=m("span",{class:"label"},"Listed items",-1)),m("span",pa,N(a.bannerData.count_on_sale??0),1)])])]),m("div",Ca,[m("img",{src:E(B)[a.bannerName].banner.image,alt:E(B)[a.bannerName].banner.name},null,8,Ea)])]),_:1},8,["to"])}}},Pa=U(wa,[["__scopeId","data-v-86560e76"]]),Oa={key:0,class:"skeleton-grid"},Ba={key:1,class:"error"},Sa={key:2,class:"grid-banner"},Ma={__name:"CollectionsBannerPanel",props:{initialBanners:{type:Object,default:()=>({})}},setup(a){const t=a,r=M(t.initialBanners||{}),o=()=>!!r.value&&Object.keys(r.value).length>0,n=M(!o()),f=M(""),s=async()=>{if(!o())try{n.value=!0,f.value="";const{data:e}=await oa();r.value=e.collections||{}}catch(e){console.error("banner load failed",e),f.value="Failed to load banners",r.value={}}finally{n.value=!1}};return F(()=>t.initialBanners,e=>{e&&Object.keys(e).length&&(r.value=e,n.value=!1,f.value="")},{deep:!0}),sa(()=>{o()||s()}),(e,h)=>(p(),C("div",null,[n.value?(p(),C("div",Oa,[(p(),C(I,null,j(3,v=>m("div",{key:v,class:"skeleton-card"})),64))])):f.value?(p(),C("p",Ba,N(f.value),1)):(p(),C("div",Sa,[(p(!0),C(I,null,j(Object.keys(r.value),v=>(p(),W(Pa,{key:v,"banner-name":v,"banner-data":r.value[v]},null,8,["banner-name","banner-data"]))),128))]))]))}},Ra=U(Ma,[["__scopeId","data-v-f1173cb6"]]);export{Ra as B,La as u};
